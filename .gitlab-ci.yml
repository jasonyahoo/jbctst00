image: node:10.15.0
    
test:
  script:
    - eval `ssh-agent -s`
    - echo "$EXT_PRIVATE_KEY" | tr -d '\r' | ssh-add -
    - mkdir -p ~/.ssh
    - chmod 700 ~/.ssh
    - ssh-keyscan github.com >> ~/.ssh/known_hosts
    - chmod 644 ~/.ssh/known_hosts
    - ls -r $BITBUCKET_CLONE_DIR
    - git config --global user.name $EXT_GIT_USR
    - git config --global user.email $EXT_GIT_EMAIL
    - git clone $EXT_GIT_CLONE_URL
    - apt-get update -y
    - apt-get -y install rsync
    - pwd
    - rsync -av --exclude=".*" --exclude="$EXT_GIT_REPO_NAME" ./ $EXT_GIT_REPO_NAME/
    - cd $EXT_GIT_REPO_NAME
    - echo "AFTER MOVE"
    - ls -R .
    - git add .
    - git commit -m "Automated Commit from GitLab - PIPELINE"
    - git push
    - echo "good day"
